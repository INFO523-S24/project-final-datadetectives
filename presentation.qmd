---
title: "Global Energy Trends"
subtitle: "INFO 523 - Spring 2023 - Project Final"
author: "Ayesha, Abhishek, Shreemithra, Toluwanimi, Valerie, Alyssa"
title-slide-attributes:
  data-background-image: images/background for intro page.webp
  data-background-size: stretch
  data-background-opacity: "0.3"
  data-slide-number: none
format:
  revealjs:
    transition: slide
    background-transition: slide
    theme:  ['data/customtheming.scss']
  
editor: visual
jupyter: python3
execute:
  warning: false
  message: false
  echo: false
---

```{python}
#| label: load-packages
#| include: false

# Load packages here
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import seaborn as sns
```

```{python}
#| label: setup
#| include: false

# Set up plot theme and figure resolution
sns.set_theme(style="whitegrid")
sns.set_context("notebook", font_scale=1.1)

import matplotlib.pyplot as plt
plt.rcParams['figure.dpi'] = 300
plt.rcParams['savefig.dpi'] = 300
plt.rcParams['figure.figsize'] = (5.7, 5.7 * 0.618)
```

```{python}
#| label: load-data Q1 
#| include: false

# Load data for Question 1 in Python
data = pd.read_csv('data/owid-energy-data.csv')

#columns to keep
keep = (['year', 'population', 'gdp', 'electricity_generation', 
      'primary_energy_consumption', 'renewables_electricity'])

#data for q1
q1_data = data[keep]

# Drop rows with any empty values
q1_data_cleaned = q1_data.dropna()

# Save the cleaned dataset to a new CSV file
q1_data_cleaned.to_csv('data/q1_energy_data_cleaned.csv', 
index = False)
```

## Project Overview and Data set

-   Energy is crucial today for powering industries, homes, and technological advancements.

-   The aim of this project is to predict power consumption trends based on population size, GDP, renewable energy usage, and identify regions transitioning to sustainable energy practices while reducing greenhouse gas emissions.

-   This data set was gathered from the **Our World in Data** website where multiple data sets were merged together to form this data.


# Question 1

------------------------------------------------------------------------

Is it possible to predict a nation's power consumption by considering its population size, gross domestic product (GDP), and the percentage of electricity generated from renewable sources and changes across the years?

<img src="/images/electricity.png" alt="electricity" width="500"/>



# Next steps


## Visualizations

::: panel-tabset
## Columns

::: {.fragment .fade-in style="font-size: 0.9em"}
-   `population` and `gdp` are directly linked to energy demand.
:::

::: {.fragment .fade-in style="font-size: 0.9em"}
-   `renewables_electricity` / `electricity_generation` are used to create a percentage.
:::

::: {.fragment .fade-in style="font-size: 0.9em"}
-   `primary_energy_consumption` is the **target variable**.
:::

::: {.fragment .fade-in style="font-size: 0.9em"}  
-   `year` is used to perfrom time series analysis.
:::

## Analysis Plan

::: {.fragment .fade-in style="font-size: 0.9em"}
-   Cleaning and manipulating the dataset.
:::

::: {.fragment .fade-in style="font-size: 0.9em"}
-   Using descriptive statistics to create distribution plots.
:::

::: {.fragment .fade-in style="font-size: 0.9em"}
-   Performing correlation analysis to visualize scatterplots. 
:::

::: {.fragment .fade-in style="font-size: 0.9em"}
-   Creating a time series analysis plot by observing the change of selected columns over time.
:::

:::

## Distribution Plot

<img src="/images/Q1%20plots/Q1_dist_plot.png" alt="distribution plot" width="650"/>


## Scatter Plot

<img src="/images/Q1%20plots/Q1_scatter.png" alt="scatter plot" width="600"/>



## Time Series Analysis Plot

<img src="/images/Q1%20plots/Q1_time_series_plot.png" alt="time series analysis plot" width="600"/>

# Question 2 

------------------------------------------------------------------------

What countries or regions are engaging in sustainable energy practices and relying more on renewable energy compared to nonrenewable energy? Which countries are moving towards the trajectory of relying more on renewable energy and producing less greenhouse gas emissions?

<img src="/images/question 2 image2.jpeg" alt="Q2 - intro" width="500"/>

<img src="/images/question 2 intro image.jpeg" alt="Q2 - intro 2" width="4"/>

------------------------------------------------------------------------

## Next steps

::: panel-tabset
### Columns

::: {.fragment .fade-in style="font-size: 0.96em"}
-   For insights into trends in renewable energy share and practices: **Solar_consumption**, **Wind_consumption**, **Hydro_consumption**, **Other_renewable_consumption**, **Renewable_energy_share**, **Greenhouse_gas_emissions**, **Renewables_electricity**, **Electricity_generation**, and **Year**.
:::

::: {.fragment .fade-in style="font-size: 0.96em"}
-   For clustering analysis: **Country**, **Year**, **Population**, **GDP**, and all energy-related columns.
:::

### Analysis Plan

::: {.fragment .fade-in style="font-size: 0.75em"}
-   A map and bar plot were utilized to reveal renewable energy consumption and greenhouse gas emissions.
:::

::: {.fragment .fade-in style="font-size: 0.75em"}
-   A line plot was used to display trends in global energy consumption.
:::

::: {.fragment .fade-in style="font-size: 0.75em"}
-   A density plot illustrated renewable energy and non-renewable energy consumption by continent.
:::

::: {.fragment .fade-in style="font-size: 0.75em"}
-   Clustering analysis was conducted on energy-related variables to identify clusters for regional boundaries based on their renewable and non-renewable energy consumption patterns.
:::
:::
------------------------------------------------------------------------

## MAP:Share of Renewable Energy Consumption

```{python, figsize=[8, 12.944]}

#| label: MAP1
#| echo: false
#| warning: false
import pandas as pd
import geopandas as gpd
import plotly.express as px

# Loading data
data = pd.read_csv("data/owid-energy-data.csv")
world = gpd.read_file(gpd.datasets.get_path('naturalearth_lowres'))

# Merging world shapefile with energy data
world = world.merge(data, how='left', left_on='iso_a3', right_on='iso_code')

# Droping NaN values from columns used in calculations
columns_to_drop_na = ['solar_consumption', 'wind_consumption', 'hydro_consumption', 'other_renewable_consumption', 'energy_per_capita']

# Filtering data from 2000 to 2023
world = world[(world['year'] >= 2000) & (world['year'] <= 2023)]

# Grouping by year and country, summing renewable energy consumption and energy per capita
world = world.groupby(['iso_a3', 'year', 'name']).agg({
    'solar_consumption': 'sum',
    'wind_consumption': 'sum',
    'hydro_consumption': 'sum',
    'other_renewable_consumption': 'sum',
    'energy_per_capita': 'mean'
}).reset_index()

# Calculating total renewable energy consumption
world['total_renewable_consumption'] = world['solar_consumption'] + world['wind_consumption'] + world['hydro_consumption'] + world['other_renewable_consumption']

# Calculate renewable energy share
world['renewable_energy_share'] = (world['total_renewable_consumption'] / world['energy_per_capita']) * 100

# Setting year column as date
world['year'] = pd.to_datetime(world['year'], format='%Y')

# Plotting the animated map
fig = px.choropleth(world, 
                    locations='iso_a3',
                    color='renewable_energy_share',
                    hover_name='name',
                    hover_data={'iso_a3': False, 'renewable_energy_share': True},
                    animation_frame=world['year'].dt.year,  
                    range_color=(0, 7),  
                    projection='natural earth',
                    color_continuous_scale=px.colors.sequential.Plasma,
                    title='')

# Setting x-axis format to display only the year
fig.update_xaxes(dtick='M1', tickformat='%Y')

fig.show()

```

------------------------------------------------------------------------

## Insights

-   This visualization reveals the share of renewable energy around the world.

-   North America has very little to adequate amount in the share of renewable energy.

-   South America has little share of renewable energy for some parts while some other parts have a large share of renewable energy.

-   Some parts of Asia also have the same renewable energy share distribution as North America with some parts having more and some having very little.

------------------------------------------------------------------------

## Barplot 1

::: panel-tabset
### Plot

```{python, figsize=[8, 12.944]}

#| label: BAR1
#| echo: false
#| warning: false

import pandas as pd
import geopandas as gpd
import plotly.graph_objects as go

world = gpd.read_file(gpd.datasets.get_path('naturalearth_lowres'))

# Merging world shapefile with energy data
world = world.merge(data, how='left', left_on='iso_a3', right_on='iso_code')

# Droping NaN values from columns used in calculations
columns_to_drop_na = ['solar_consumption', 'wind_consumption', 'hydro_consumption', 'other_renewable_consumption', 'energy_per_capita']

# Filtering data from 2000 to 2023
world = world[(world['year'] >= 2000) & (world['year'] <= 2023)]

# Grouping by year and country, summing renewable energy consumption and energy per capita
world = world.groupby(['iso_a3', 'year', 'name']).agg({
    'solar_consumption': 'sum',
    'wind_consumption': 'sum',
    'hydro_consumption': 'sum',
    'other_renewable_consumption': 'sum',
    'energy_per_capita': 'mean'
}).reset_index()

# Calculating total renewable energy consumption
world['total_renewable_consumption'] = world['solar_consumption'] + world['wind_consumption'] + world['hydro_consumption'] + world['other_renewable_consumption']

# Calculating renewable energy share
world['renewable_energy_share'] = (world['total_renewable_consumption'] / world['energy_per_capita']) * 100

# Making year column as date
world['year'] = pd.to_datetime(world['year'], format='%Y')

# Calculating mean renewable energy share by country
country_stats = world.groupby('name')['renewable_energy_share'].mean().reset_index()

# Identifying top 10 countries with the highest mean renewable energy share
top_10_countries = country_stats.nlargest(10, 'renewable_energy_share')['name'].tolist()

# Filtering data for top 10 countries
top_10_world = world[world['name'].isin(top_10_countries)]

# Sorting data by renewable energy share
top_10_world = top_10_world.sort_values(by='renewable_energy_share', ascending=False)
# Plotting the animated bar plot with Plotly Graph Objects
fig = go.Figure()

# Defining custom color scale from light green to dark green
custom_color_scale = [
    [0, 'rgba(0, 255, 0, 0.5)'],
    [0.2, 'rgba(0, 255, 0, 0.6)'],
    [0.4, 'rgba(0, 255, 0, 0.7)'],
    [0.6, 'rgba(0, 255, 0, 0.8)'],
    [0.8, 'rgba(0, 255, 0, 0.9)'],
    [1, 'rgba(0, 255, 0, 1.0)']
]

# Creating bar traces for each year
for year, df in top_10_world.groupby('year'):
    fig.add_trace(go.Bar(
        x=df['name'],
        y=df['renewable_energy_share'],
        name=str(year.year),
        hoverinfo='x+y',
        hovertemplate='<b>%{x}</b><br>Renewable Energy Share: %{y:.2f}%<extra></extra>',
        visible=False if year != top_10_world['year'].min() else True,
        marker=dict(
            color=df['renewable_energy_share'],
            colorscale=custom_color_scale,
            colorbar=dict(title='Renewable Energy Share (%)')
        )
    ))

# Adding play button and slider
fig.update_layout(
    updatemenus=[dict(
        type="buttons",
        buttons=[dict(label="Play",
                      method="animate",
                      args=[None, {"frame": {"duration": 500, "redraw": True}, "fromcurrent": True, "transition": {"duration": 300, "easing": "quadratic-in-out"}}]
        )]
    )],
    title='Top 10 Countries with Highest Mean Renewable Energy Share',
    xaxis=dict(title='Country'),
    yaxis=dict(title='Mean Renewable Energy Share (%)', range=[0, 20])
)

# Setting initial layout
fig.update_layout(showlegend=False)

# Creating frames for each year
frames = [go.Frame(
    data=[go.Bar(
        x=df['name'],
        y=df['renewable_energy_share'],
        name=str(year.year),
        hoverinfo='x+y',
        hovertemplate='<b>%{x}</b><br>Renewable Energy Share: %{y:.2f}%<extra></extra>',
        marker=dict(
            color=df['renewable_energy_share'],
            colorscale=custom_color_scale,
            colorbar=dict(title='Renewable Energy Share (%)')
        )
    )],
    name=str(year.year)
) for year, df in top_10_world.groupby('year')]

# Adding frames to the figure
fig.frames = frames

fig.show()


```

### Insights

This plot reveals that countries such as China, Brazil, and India have a relatively high share of renewable energy.

However, countries such as Pakistan, Vietnam, Columbia, the United States of America, Canada, and Indonesia have relatively much lower shares of renewable energy.

:::

------------------------------------------------------------------------

## Barplot 2

::: panel-tabset
## Plot

```{python, figsize=[8, 12.4]}


#| label: BAR2
#| echo: false
#| warning: false
import pandas as pd
import geopandas as gpd
import plotly.express as px

# Read world shapefile
world = gpd.read_file(gpd.datasets.get_path('naturalearth_lowres'))

# Merging world shapefile with energy data
world = world.merge(data, how='left', left_on='iso_a3', right_on='iso_code')

# Dropping NaN values from columns used in calculations
columns_to_drop_na = ['solar_consumption', 'wind_consumption', 'hydro_consumption', 'other_renewable_consumption', 'energy_per_capita']
world = world.dropna(subset=columns_to_drop_na)

# Filtering data from 2000 to 2023
world = world[(world['year'] >= 2000) & (world['year'] <= 2023)]

# Grouping by year and country, summing renewable energy consumption and energy per capita
world = world.groupby(['iso_a3', 'year', 'name']).agg({
    'solar_consumption': 'sum',
    'wind_consumption': 'sum',
    'hydro_consumption': 'sum',
    'other_renewable_consumption': 'sum',
    'energy_per_capita': 'mean',
    'greenhouse_gas_emissions': 'mean'
}).reset_index()

# Calculating total renewable energy consumption
world['total_renewable_consumption'] = world['solar_consumption'] + world['wind_consumption'] + world['hydro_consumption'] + world['other_renewable_consumption']

# Calculating renewable energy share
world['renewable_energy_share'] = (world['total_renewable_consumption'] / world['energy_per_capita']) * 100

# Setting year column as date
world['year'] = pd.to_datetime(world['year'], format='%Y')

# Calculating mean renewable energy share and greenhouse gas emissions by country
country_stats = world.groupby('name').agg({
    'renewable_energy_share': 'mean',
    'greenhouse_gas_emissions': 'mean'
}).reset_index()

# Sorting countries by greenhouse gas emissions and selecting top 10
top_emissions_countries = country_stats.nlargest(10, 'greenhouse_gas_emissions')

# Defining width and height based on the golden ratio
width = 1050

# Creating vertical bar plot with color gradient for greenhouse gas emissions
fig_high_emissions = px.bar(top_emissions_countries, 
                             x='name', 
                             y='greenhouse_gas_emissions', 
                             color='greenhouse_gas_emissions',
                             labels={'greenhouse_gas_emissions': 'Mean Greenhouse Gas<br>(megatonnes of CO₂ equivalents)'},
                             title='Top 10 Countries with Highest Mean Greenhouse Gas Emissions',
                             orientation='v',
                             color_continuous_scale='Emrld', width=width)

# Updating x-axis label for emissions plot
fig_high_emissions.update_xaxes(title='Country')

# Updating color bar title
fig_high_emissions.update_coloraxes(colorbar_title='Mean Greenhouse Gas<br>(megatonnes of CO₂ equivalents)')

# Showing plot for most greenhouse gas emissions
fig_high_emissions.show()


```

## Insight

This plot reveals the top 10 countries with mean green house emissions.

Countries such as China and the United states have the highest green house emissions out amongst the top 10 countries.

This is followed by INdian, Japan, Russia, Germany, South Korea, South Africa, Australia, and the United Kingdom.
:::

------------------------------------------------------------------------

## Line plot

<img src="/images/Q2plot/Q2_line_plot.png" alt="q2 - line plot" width="730"/>


------------------------------------------------------------------------

## Insights

- This visualization provides information on the energy consumption of wind, solar, and hydro energy over the years.

- This plot reveals that Hydro electric power has always been in the lead in terms of energy consumed over the years. Its consumption seems to have climbed steadily over the years.

- Wind and Solar Energy consumption seems to have taken off in the early 2000s and have continued to climb steadilty over the years with more of wind energy being consumed than solar energy.



# Density plots

------------------------------------------------------------------------

### Renewable Energy Consumption

![](images/renewables_consumption_by_continent.gif)

------------------------------------------------------------------------

### Non-Renewable Energy Consumption

![](images/non_renewables_consumption_by_continent.gif)

------------------------------------------------------------------------

## Insights

::: panel-tabset
## Renewable Energy Plot

-   This plot reveals that South America are the leading continents in terms of renewable energy conosumption.

-   Africa has a very steep density curve implying that its consumption of renewable energy has barely grown over the years.

## Non-Renewable Energy Plot

-   This plot reveals that Europe is one of the largest consumers of non-renewable energy.

-   Asia has also had its consumption of non-renewable energy grow by large amounts over the years.
:::

## Clustering Plots

::: panel-tabset
### K-Means

<img src="/images/Q2plot/Q2_Kmean.png" alt="distribution plot" width="640"/>

### DBSCAN

<img src="/images/Q2plot/Q2_db.png" alt="distribution plot" width="720"/>

:::

------------------------------------------------------------------------

## Insights

-   This cluster analysis resulted in **8 clusters** when the K-Means was used.

-   After the DBSCAN was conducted, **2 clusters** emerged while one remained an outlier.

-   A silhoutte score was calculated to determine the accuracy of this cluster which yielded a score of **0.96**.

-   This implies that the cluster method developed here was very effective.

------------------------------------------------------------------------

## Conclusion

::: {.fragment .fade-in style="font-size: 0.7em"}
-   Economic and demographic growth often coincide with increased energy demand, while shifts in renewable energy proportion suggest changes in energy source composition. Analyzing these patterns aids in forecasting future power consumption trends.
:::

::: {.fragment .fade-in style="font-size: 0.7em"}
-   Nations like China, India, Brazil, and the USA are at the forefront of renewable energy adoption, yet persistent greenhouse gas emissions in some countries necessitate intensified emission reduction endeavors.
:::

::: {.fragment .fade-in style="font-size: 0.7em"}
-   Continental Dynamics: While there's a global upsurge in renewable energy utilization, simultaneous spikes in non-renewable consumption highlight the ongoing imperative for sustainable energy transitions.
:::

::: {.fragment .fade-in style="font-size: 0.7em"}
-   Clustering techniques unveil regions preferring renewable energy over non-renewable sources, offering crucial insights for targeted sustainability strategies.
:::

## References

-   [Revealjs](https://quarto.org/docs/presentations/revealjs/)
-   [Data](https://ourworldindata.org/energy)
-   [TidyTuesday - GH](https://github.com/owid/energy-data)
-   [Image formatting](https://stackoverflow.com/questions/34138412/reveal-js-how-to-add-an-image-to-a-slide)

------------------------------------------------------------------------

![](images/thank you gif2.gif){fig-align="center" width="800"}